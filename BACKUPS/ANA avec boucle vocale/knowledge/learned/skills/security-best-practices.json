{
  "category": "security-best-practices",
  "version": "1.0.0",
  "generatedBy": "Ana SUPERIA (DeepSeek Coder) - Supervisé et corrigé par Claude",
  "skills": [
    {"id": "sec01", "type": "validation", "name": "Input Validation", "description": "Validate and sanitize all inputs to prevent injection attacks", "pattern": "if (!filter_input(INPUT_POST, 'username', FILTER_SANITIZE_STRING)) { throw new ValidationException(); }", "example": "Sanitize username input before processing"},
    {"id": "sec02", "type": "xss", "name": "XSS Prevention", "description": "Use output encoding to prevent cross-site scripting attacks", "pattern": "echo htmlspecialchars($userInput, ENT_QUOTES, 'UTF-8');", "example": "Encode user input before displaying in HTML"},
    {"id": "sec03", "type": "sql", "name": "SQL Injection Prevention", "description": "Use parameterized queries to prevent SQL injection", "pattern": "$stmt = $pdo->prepare('SELECT * FROM users WHERE id = :id');\n$stmt->execute([':id' => $userId]);", "example": "Never concatenate user input into SQL queries"},
    {"id": "sec04", "type": "csrf", "name": "CSRF Protection", "description": "Use anti-CSRF tokens to verify request authenticity", "pattern": "<input type='hidden' name='csrf_token' value='<?= bin2hex(random_bytes(32)) ?>'>\n// Verify: hash_equals($_SESSION['csrf'], $_POST['csrf_token'])", "example": "Include and verify token in all state-changing forms"},
    {"id": "sec05", "type": "auth", "name": "Secure Authentication", "description": "Implement secure login with rate limiting and account lockout", "pattern": "if ($failedAttempts >= 5) {\n  $lockoutUntil = time() + 900; // 15 min\n  throw new AccountLockedException();\n}", "example": "Prevent brute force attacks with lockout"},
    {"id": "sec06", "type": "password", "name": "Password Hashing", "description": "Use strong hashing algorithms for password storage", "pattern": "$hash = password_hash($password, PASSWORD_ARGON2ID);\n// Verify: password_verify($input, $hash)", "example": "Use Argon2id or bcrypt, never MD5/SHA1"},
    {"id": "sec07", "type": "jwt", "name": "JWT Security", "description": "Secure JWT implementation with proper signing and expiration", "pattern": "const token = jwt.sign(\n  { userId: user.id },\n  process.env.JWT_SECRET,\n  { algorithm: 'RS256', expiresIn: '15m' }\n);", "example": "Use RS256, short expiry, secure secret storage"},
    {"id": "sec08", "type": "cors", "name": "CORS Configuration", "description": "Configure CORS with specific allowed origins", "pattern": "header('Access-Control-Allow-Origin: https://trusted-app.com');\nheader('Access-Control-Allow-Credentials: true');", "example": "Never use * in production, whitelist specific domains"},
    {"id": "sec09", "type": "ratelimit", "name": "Rate Limiting", "description": "Limit request frequency to prevent abuse", "pattern": "const limiter = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max: 100,\n  message: 'Too many requests'\n});", "example": "Implement per-user and per-IP rate limits"},
    {"id": "sec10", "type": "headers", "name": "Security Headers", "description": "Add HTTP security headers to responses", "pattern": "X-Content-Type-Options: nosniff\nX-Frame-Options: DENY\nX-XSS-Protection: 1; mode=block\nReferrer-Policy: strict-origin-when-cross-origin", "example": "Set headers on all responses"},
    {"id": "sec11", "type": "tls", "name": "HTTPS/TLS Enforcement", "description": "Enforce encrypted connections with HSTS", "pattern": "Strict-Transport-Security: max-age=31536000; includeSubDomains; preload", "example": "Redirect HTTP to HTTPS, enable HSTS preload"},
    {"id": "sec12", "type": "secrets", "name": "Secrets Management", "description": "Store secrets securely in environment or vault", "pattern": "const apiKey = process.env.API_KEY;\n// Or use: const { SecretClient } = require('@azure/keyvault-secrets');", "example": "Never commit secrets to git, use env vars or vault"},
    {"id": "sec13", "type": "scanning", "name": "Dependency Scanning", "description": "Regularly scan dependencies for vulnerabilities", "pattern": "npm audit\ncomposer audit\nsnyk test\ndependabot alerts", "example": "Run in CI/CD pipeline, fix high severity issues"},
    {"id": "sec14", "type": "injection", "name": "Code Injection Prevention", "description": "Prevent arbitrary code execution", "pattern": "// NEVER use eval() with user input\n// Use allowlist validation instead\nif (!allowedCommands.includes(input)) { throw new Error('Invalid'); }", "example": "Avoid eval, new Function, exec with user data"},
    {"id": "sec15", "type": "path", "name": "Path Traversal Prevention", "description": "Restrict file access to authorized directories", "pattern": "const safePath = path.join(baseDir, path.basename(userInput));\nif (!safePath.startsWith(baseDir)) { throw new Error('Invalid path'); }", "example": "Use basename, validate against allowed directory"},
    {"id": "sec16", "type": "session", "name": "Session Management", "description": "Implement secure session handling", "pattern": "session_regenerate_id(true); // On login\nini_set('session.cookie_httponly', 1);\nini_set('session.cookie_secure', 1);", "example": "Regenerate ID on auth, use secure cookies"},
    {"id": "sec17", "type": "encryption", "name": "Data Encryption", "description": "Encrypt sensitive data at rest and in transit", "pattern": "const cipher = crypto.createCipheriv('aes-256-gcm', key, iv);\nconst encrypted = cipher.update(data) + cipher.final();", "example": "Use AES-256-GCM, secure key management"},
    {"id": "sec18", "type": "access", "name": "Access Control", "description": "Implement role-based access control (RBAC)", "pattern": "function checkPermission(user, resource, action) {\n  return user.roles.some(role => \n    permissions[role]?.[resource]?.includes(action)\n  );\n}", "example": "Verify permissions on every protected action"},
    {"id": "sec19", "type": "owasp", "name": "OWASP Top 10 Checklist", "description": "Follow OWASP Top 10 security guidelines", "pattern": "A01: Broken Access Control\nA02: Cryptographic Failures\nA03: Injection\nA04: Insecure Design\nA05: Security Misconfiguration\nA06: Vulnerable Components\nA07: Auth Failures\nA08: Integrity Failures\nA09: Logging Failures\nA10: SSRF", "example": "Reference: owasp.org/Top10"},
    {"id": "sec20", "type": "logging", "name": "Security Logging", "description": "Log security events for monitoring and forensics", "pattern": "logger.warn('Failed login attempt', {\n  userId: input.email,\n  ip: req.ip,\n  timestamp: new Date().toISOString()\n});", "example": "Log auth failures, access violations, anomalies"},
    {"id": "sec21", "type": "csp", "name": "Content Security Policy", "description": "Restrict resource loading with CSP headers", "pattern": "Content-Security-Policy: default-src 'self'; script-src 'self' 'nonce-abc123'; style-src 'self' 'unsafe-inline'", "example": "Block inline scripts, restrict external resources"},
    {"id": "sec22", "type": "ratelimit", "name": "Rate Limit Headers", "description": "Communicate rate limits to clients", "pattern": "X-RateLimit-Limit: 100\nX-RateLimit-Remaining: 95\nX-RateLimit-Reset: 1640000000", "example": "Help clients implement proper retry logic"},
    {"id": "sec23", "type": "headers", "name": "Server Header Removal", "description": "Hide server information from responses", "pattern": "server_tokens off; # Nginx\nServerTokens Prod # Apache\napp.disable('x-powered-by'); # Express", "example": "Don't reveal server software versions"},
    {"id": "sec24", "type": "clickjack", "name": "Clickjacking Protection", "description": "Prevent UI redressing attacks", "pattern": "X-Frame-Options: DENY\nContent-Security-Policy: frame-ancestors 'none'", "example": "Prevent embedding in iframes on other sites"},
    {"id": "sec25", "type": "hsts", "name": "HSTS Implementation", "description": "Force HTTPS via browser caching", "pattern": "Strict-Transport-Security: max-age=63072000; includeSubDomains; preload", "example": "Submit to HSTS preload list for max protection"},
    {"id": "sec26", "type": "sanitize", "name": "HTML Sanitization", "description": "Sanitize HTML to prevent XSS in rich content", "pattern": "import DOMPurify from 'dompurify';\nconst clean = DOMPurify.sanitize(userHtml, { ALLOWED_TAGS: ['b', 'i', 'em', 'strong'] });", "example": "Use DOMPurify or similar for user HTML"},
    {"id": "sec27", "type": "csp", "name": "CSP Reporting", "description": "Monitor CSP violations for security insights", "pattern": "Content-Security-Policy-Report-Only: default-src 'self'; report-uri /csp-report", "example": "Deploy in report-only mode first, then enforce"},
    {"id": "sec28", "type": "session", "name": "Session Fixation Prevention", "description": "Regenerate session ID after authentication", "pattern": "session_regenerate_id(true); // PHP\nreq.session.regenerate(); // Express", "example": "Always regenerate session on privilege change"},
    {"id": "sec29", "type": "idor", "name": "IDOR Prevention", "description": "Prevent insecure direct object references", "pattern": "const doc = await Document.findById(id);\nif (doc.ownerId !== currentUser.id && !currentUser.isAdmin) {\n  throw new ForbiddenError();\n}", "example": "Always verify ownership before access"},
    {"id": "sec30", "type": "headers", "name": "Complete Security Headers", "description": "Comprehensive security header configuration", "pattern": "Strict-Transport-Security: max-age=31536000\nX-Content-Type-Options: nosniff\nX-Frame-Options: DENY\nContent-Security-Policy: default-src 'self'\nPermissions-Policy: geolocation=(), camera=()", "example": "Apply all headers via middleware/proxy"}
  ]
}
