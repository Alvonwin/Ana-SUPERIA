{
  "category": "terraform-modules",
  "version": "1.0.0",
  "generatedBy": "Claude (Opus 4.5)",
  "description": "Terraform module patterns and best practices",
  "skills": [
    {"id": "tfm01", "type": "structure", "name": "Module Structure", "description": "File layout", "pattern": "modules/\n  vpc/\n    main.tf        # Resources\n    variables.tf   # Input variables\n    outputs.tf     # Output values\n    versions.tf    # Provider versions\n    README.md      # Documentation", "example": "Module structure"},
    {"id": "tfm02", "type": "call", "name": "Call Module", "description": "Use module", "pattern": "module \"vpc\" {\n  source = \"./modules/vpc\"\n  \n  name        = \"production-vpc\"\n  cidr_block  = \"10.0.0.0/16\"\n  environment = var.environment\n}", "example": "Call module"},
    {"id": "tfm03", "type": "registry", "name": "Registry Module", "description": "Public modules", "pattern": "module \"vpc\" {\n  source  = \"terraform-aws-modules/vpc/aws\"\n  version = \"5.0.0\"\n  \n  name = \"my-vpc\"\n  cidr = \"10.0.0.0/16\"\n  azs  = [\"us-east-1a\", \"us-east-1b\"]\n}", "example": "Registry module"},
    {"id": "tfm04", "type": "git", "name": "Git Source", "description": "Git repository", "pattern": "module \"example\" {\n  source = \"git::https://github.com/org/repo.git//modules/example?ref=v1.0.0\"\n}\n\nmodule \"private\" {\n  source = \"git::ssh://git@github.com/org/private-repo.git?ref=main\"\n}", "example": "Git source"},
    {"id": "tfm05", "type": "input", "name": "Input Variables", "description": "Module inputs", "pattern": "variable \"name\" {\n  description = \"Name of the VPC\"\n  type        = string\n}\n\nvariable \"subnets\" {\n  description = \"Subnet configurations\"\n  type = list(object({\n    cidr = string\n    az   = string\n  }))\n}", "example": "Input variables"},
    {"id": "tfm06", "type": "output", "name": "Output Values", "description": "Module outputs", "pattern": "output \"vpc_id\" {\n  description = \"ID of the VPC\"\n  value       = aws_vpc.main.id\n}\n\noutput \"subnet_ids\" {\n  description = \"List of subnet IDs\"\n  value       = aws_subnet.main[*].id\n}", "example": "Output values"},
    {"id": "tfm07", "type": "validation", "name": "Variable Validation", "description": "Input validation", "pattern": "variable \"environment\" {\n  type = string\n  validation {\n    condition     = contains([\"dev\", \"staging\", \"prod\"], var.environment)\n    error_message = \"Environment must be dev, staging, or prod.\"\n  }\n}", "example": "Validation"},
    {"id": "tfm08", "type": "default", "name": "Default Values", "description": "Optional inputs", "pattern": "variable \"instance_type\" {\n  type    = string\n  default = \"t3.micro\"\n}\n\nvariable \"tags\" {\n  type    = map(string)\n  default = {}\n}", "example": "Default values"},
    {"id": "tfm09", "type": "sensitive", "name": "Sensitive Variables", "description": "Hide values", "pattern": "variable \"db_password\" {\n  type      = string\n  sensitive = true\n}\n\noutput \"connection_string\" {\n  value     = \"postgres://user:${var.db_password}@host/db\"\n  sensitive = true\n}", "example": "Sensitive"},
    {"id": "tfm10", "type": "locals", "name": "Local Values", "description": "Computed values", "pattern": "locals {\n  name_prefix = \"${var.project}-${var.environment}\"\n  common_tags = merge(var.tags, {\n    Project     = var.project\n    Environment = var.environment\n    ManagedBy   = \"terraform\"\n  })\n}", "example": "Local values"},
    {"id": "tfm11", "type": "count", "name": "Conditional Resources", "description": "Count condition", "pattern": "variable \"create_bucket\" {\n  type    = bool\n  default = true\n}\n\nresource \"aws_s3_bucket\" \"this\" {\n  count  = var.create_bucket ? 1 : 0\n  bucket = var.bucket_name\n}", "example": "Conditional"},
    {"id": "tfm12", "type": "for_each", "name": "For Each Resources", "description": "Multiple instances", "pattern": "variable \"buckets\" {\n  type = map(object({\n    versioning = bool\n  }))\n}\n\nresource \"aws_s3_bucket\" \"this\" {\n  for_each = var.buckets\n  bucket   = each.key\n}", "example": "For each"},
    {"id": "tfm13", "type": "dynamic", "name": "Dynamic Blocks", "description": "Generated blocks", "pattern": "resource \"aws_security_group\" \"this\" {\n  dynamic \"ingress\" {\n    for_each = var.ingress_rules\n    content {\n      from_port   = ingress.value.from_port\n      to_port     = ingress.value.to_port\n      protocol    = ingress.value.protocol\n      cidr_blocks = ingress.value.cidr_blocks\n    }\n  }\n}", "example": "Dynamic blocks"},
    {"id": "tfm14", "type": "providers", "name": "Provider Aliases", "description": "Multiple providers", "pattern": "provider \"aws\" {\n  region = \"us-east-1\"\n}\n\nprovider \"aws\" {\n  alias  = \"west\"\n  region = \"us-west-2\"\n}\n\nmodule \"west_vpc\" {\n  source = \"./modules/vpc\"\n  providers = {\n    aws = aws.west\n  }\n}", "example": "Provider aliases"},
    {"id": "tfm15", "type": "depends", "name": "Module Dependencies", "description": "Explicit deps", "pattern": "module \"database\" {\n  source = \"./modules/database\"\n  vpc_id = module.vpc.vpc_id\n  \n  depends_on = [module.vpc]\n}", "example": "Dependencies"},
    {"id": "tfm16", "type": "version", "name": "Version Constraints", "description": "Pin versions", "pattern": "terraform {\n  required_version = \">= 1.5.0\"\n  \n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 5.0\"\n    }\n  }\n}", "example": "Versions"},
    {"id": "tfm17", "type": "backend", "name": "Backend Config", "description": "State storage", "pattern": "terraform {\n  backend \"s3\" {\n    bucket         = \"terraform-state\"\n    key            = \"modules/vpc/terraform.tfstate\"\n    region         = \"us-east-1\"\n    encrypt        = true\n    dynamodb_table = \"terraform-locks\"\n  }\n}", "example": "Backend config"},
    {"id": "tfm18", "type": "remote", "name": "Remote State Data", "description": "Cross-module state", "pattern": "data \"terraform_remote_state\" \"vpc\" {\n  backend = \"s3\"\n  config = {\n    bucket = \"terraform-state\"\n    key    = \"vpc/terraform.tfstate\"\n    region = \"us-east-1\"\n  }\n}\n\n# Use: data.terraform_remote_state.vpc.outputs.vpc_id", "example": "Remote state"},
    {"id": "tfm19", "type": "moved", "name": "Moved Blocks", "description": "Refactor safely", "pattern": "moved {\n  from = aws_instance.web\n  to   = module.compute.aws_instance.web\n}\n\nmoved {\n  from = aws_instance.app[0]\n  to   = aws_instance.app[\"primary\"]\n}", "example": "Moved blocks"},
    {"id": "tfm20", "type": "import", "name": "Import Blocks", "description": "Import resources", "pattern": "import {\n  to = aws_instance.web\n  id = \"i-1234567890abcdef0\"\n}\n\nresource \"aws_instance\" \"web\" {\n  # Configuration matching the imported resource\n}", "example": "Import blocks"},
    {"id": "tfm21", "type": "check", "name": "Preconditions", "description": "Validate state", "pattern": "resource \"aws_instance\" \"web\" {\n  lifecycle {\n    precondition {\n      condition     = data.aws_ami.ubuntu.architecture == \"x86_64\"\n      error_message = \"AMI must be x86_64 architecture.\"\n    }\n  }\n}", "example": "Preconditions"},
    {"id": "tfm22", "type": "check", "name": "Postconditions", "description": "Verify result", "pattern": "resource \"aws_instance\" \"web\" {\n  lifecycle {\n    postcondition {\n      condition     = self.public_ip != \"\"\n      error_message = \"Instance must have a public IP.\"\n    }\n  }\n}", "example": "Postconditions"},
    {"id": "tfm23", "type": "nullable", "name": "Nullable Variables", "description": "Allow null", "pattern": "variable \"override_name\" {\n  type     = string\n  default  = null\n  nullable = true\n}\n\nlocals {\n  name = coalesce(var.override_name, \"default-name\")\n}", "example": "Nullable"},
    {"id": "tfm24", "type": "optional", "name": "Optional Attributes", "description": "Object optionals", "pattern": "variable \"config\" {\n  type = object({\n    name     = string\n    port     = optional(number, 8080)\n    enabled  = optional(bool, true)\n    metadata = optional(map(string), {})\n  })\n}", "example": "Optional attrs"},
    {"id": "tfm25", "type": "replace", "name": "Replace Triggered By", "description": "Force replacement", "pattern": "resource \"aws_instance\" \"web\" {\n  lifecycle {\n    replace_triggered_by = [\n      aws_security_group.web.id,\n      null_resource.force_replace\n    ]\n  }\n}", "example": "Replace triggered"},
    {"id": "tfm26", "type": "test", "name": "Terraform Test", "description": "Module testing", "pattern": "# tests/vpc_test.tftest.hcl\nrun \"create_vpc\" {\n  command = plan\n  \n  variables {\n    name = \"test-vpc\"\n  }\n  \n  assert {\n    condition     = aws_vpc.main.cidr_block == \"10.0.0.0/16\"\n    error_message = \"VPC CIDR must be 10.0.0.0/16\"\n  }\n}", "example": "Terraform test"},
    {"id": "tfm27", "type": "function", "name": "Custom Functions", "description": "Provider functions", "pattern": "# Using provider functions (Terraform 1.8+)\nlocals {\n  decoded = provider::aws::arn_parse(var.arn)\n  region  = local.decoded.region\n}", "example": "Custom functions"},
    {"id": "tfm28", "type": "expression", "name": "Complex Expressions", "description": "For expressions", "pattern": "locals {\n  # Filter and transform\n  public_subnets = {\n    for k, v in var.subnets : k => v\n    if v.public == true\n  }\n  \n  # Flatten nested structures\n  all_rules = flatten([\n    for sg in var.security_groups : sg.rules\n  ])\n}", "example": "Expressions"},
    {"id": "tfm29", "type": "override", "name": "Override Files", "description": "File overrides", "pattern": "# main.tf - base configuration\n# main_override.tf - local overrides (not committed)\n\n# Override files merge with base files\n# Useful for local development settings", "example": "Override files"},
    {"id": "tfm30", "type": "doc", "name": "Module Documentation", "description": "terraform-docs", "pattern": "# Generate documentation\nterraform-docs markdown table . > README.md\n\n# .terraform-docs.yml\nformatter: markdown table\noutput:\n  file: README.md\n  mode: inject", "example": "Documentation"}
  ]
}
