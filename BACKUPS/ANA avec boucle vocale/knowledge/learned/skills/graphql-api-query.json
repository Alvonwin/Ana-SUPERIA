{
  "category": "graphql-api-query",
  "version": "1.0.0",
  "generatedBy": "Claude (Opus 4.5)",
  "description": "GraphQL API query patterns",
  "skills": [
    {"id": "gql01", "type": "setup", "name": "Install GraphQL", "description": "NPM install", "pattern": "npm install graphql @apollo/server\n// Client\nnpm install @apollo/client graphql", "example": "Install"},
    {"id": "gql02", "type": "schema", "name": "Define Schema", "description": "Type definitions", "pattern": "const typeDefs = `#graphql\n  type User {\n    id: ID!\n    name: String!\n    email: String!\n    posts: [Post!]!\n  }\n  \n  type Post {\n    id: ID!\n    title: String!\n    content: String\n    author: User!\n  }\n  \n  type Query {\n    users: [User!]!\n    user(id: ID!): User\n    posts: [Post!]!\n  }\n`;", "example": "Schema"},
    {"id": "gql03", "type": "resolvers", "name": "Resolvers", "description": "Resolve fields", "pattern": "const resolvers = {\n  Query: {\n    users: () => db.users.findAll(),\n    user: (_, { id }) => db.users.findById(id),\n    posts: () => db.posts.findAll()\n  },\n  User: {\n    posts: (parent) => db.posts.findByAuthor(parent.id)\n  },\n  Post: {\n    author: (parent) => db.users.findById(parent.authorId)\n  }\n};", "example": "Resolvers"},
    {"id": "gql04", "type": "server", "name": "Apollo Server", "description": "Create server", "pattern": "import { ApolloServer } from '@apollo/server';\nimport { startStandaloneServer } from '@apollo/server/standalone';\n\nconst server = new ApolloServer({\n  typeDefs,\n  resolvers\n});\n\nconst { url } = await startStandaloneServer(server, {\n  listen: { port: 4000 }\n});\n\nconsole.log(`Server ready at ${url}`);", "example": "Server"},
    {"id": "gql05", "type": "express", "name": "Express Integration", "description": "With Express", "pattern": "import express from 'express';\nimport { expressMiddleware } from '@apollo/server/express4';\nimport cors from 'cors';\n\nconst app = express();\nawait server.start();\n\napp.use('/graphql',\n  cors(),\n  express.json(),\n  expressMiddleware(server, {\n    context: async ({ req }) => ({ token: req.headers.authorization })\n  })\n);", "example": "Express"},
    {"id": "gql06", "type": "query", "name": "Query Operation", "description": "Fetch data", "pattern": "query GetUsers {\n  users {\n    id\n    name\n    email\n    posts {\n      title\n    }\n  }\n}\n\nquery GetUser($id: ID!) {\n  user(id: $id) {\n    name\n    email\n  }\n}", "example": "Query"},
    {"id": "gql07", "type": "mutation", "name": "Mutation", "description": "Modify data", "pattern": "const typeDefs = `#graphql\n  type Mutation {\n    createUser(input: CreateUserInput!): User!\n    updateUser(id: ID!, input: UpdateUserInput!): User\n    deleteUser(id: ID!): Boolean!\n  }\n  \n  input CreateUserInput {\n    name: String!\n    email: String!\n  }\n`;\n\nconst resolvers = {\n  Mutation: {\n    createUser: (_, { input }) => db.users.create(input)\n  }\n};", "example": "Mutation"},
    {"id": "gql08", "type": "subscription", "name": "Subscriptions", "description": "Real-time updates", "pattern": "import { createServer } from 'http';\nimport { WebSocketServer } from 'ws';\nimport { useServer } from 'graphql-ws/lib/use/ws';\n\nconst typeDefs = `#graphql\n  type Subscription {\n    postCreated: Post!\n  }\n`;\n\nconst resolvers = {\n  Subscription: {\n    postCreated: {\n      subscribe: () => pubsub.asyncIterator(['POST_CREATED'])\n    }\n  }\n};", "example": "Subscription"},
    {"id": "gql09", "type": "client", "name": "Apollo Client", "description": "Setup client", "pattern": "import { ApolloClient, InMemoryCache, ApolloProvider } from '@apollo/client';\n\nconst client = new ApolloClient({\n  uri: 'http://localhost:4000/graphql',\n  cache: new InMemoryCache()\n});\n\n<ApolloProvider client={client}>\n  <App />\n</ApolloProvider>", "example": "Client"},
    {"id": "gql10", "type": "useQuery", "name": "useQuery Hook", "description": "Query in React", "pattern": "import { useQuery, gql } from '@apollo/client';\n\nconst GET_USERS = gql`\n  query GetUsers {\n    users {\n      id\n      name\n    }\n  }\n`;\n\nfunction Users() {\n  const { loading, error, data } = useQuery(GET_USERS);\n  \n  if (loading) return <p>Loading...</p>;\n  if (error) return <p>Error: {error.message}</p>;\n  \n  return data.users.map(user => <div key={user.id}>{user.name}</div>);\n}", "example": "useQuery"},
    {"id": "gql11", "type": "useMutation", "name": "useMutation Hook", "description": "Mutate in React", "pattern": "import { useMutation, gql } from '@apollo/client';\n\nconst CREATE_USER = gql`\n  mutation CreateUser($input: CreateUserInput!) {\n    createUser(input: $input) {\n      id\n      name\n    }\n  }\n`;\n\nfunction CreateUser() {\n  const [createUser, { loading }] = useMutation(CREATE_USER);\n  \n  const handleSubmit = () => {\n    createUser({ variables: { input: { name, email } } });\n  };\n}", "example": "useMutation"},
    {"id": "gql12", "type": "variables", "name": "Variables", "description": "Query variables", "pattern": "const GET_USER = gql`\n  query GetUser($id: ID!) {\n    user(id: $id) {\n      name\n      email\n    }\n  }\n`;\n\nconst { data } = useQuery(GET_USER, {\n  variables: { id: '123' }\n});", "example": "Variables"},
    {"id": "gql13", "type": "fragments", "name": "Fragments", "description": "Reusable fields", "pattern": "const USER_FIELDS = gql`\n  fragment UserFields on User {\n    id\n    name\n    email\n  }\n`;\n\nconst GET_USER = gql`\n  ${USER_FIELDS}\n  query GetUser($id: ID!) {\n    user(id: $id) {\n      ...UserFields\n      posts {\n        title\n      }\n    }\n  }\n`;", "example": "Fragments"},
    {"id": "gql14", "type": "context", "name": "Context", "description": "Request context", "pattern": "const server = new ApolloServer({\n  typeDefs,\n  resolvers,\n});\n\napp.use('/graphql', expressMiddleware(server, {\n  context: async ({ req }) => {\n    const token = req.headers.authorization;\n    const user = await getUserFromToken(token);\n    return { user, db };\n  }\n}));\n\n// In resolver\nconst resolvers = {\n  Query: {\n    me: (_, __, { user }) => user\n  }\n};", "example": "Context"},
    {"id": "gql15", "type": "auth", "name": "Authentication", "description": "Auth directive", "pattern": "const typeDefs = `#graphql\n  directive @auth on FIELD_DEFINITION\n  \n  type Query {\n    publicData: String\n    privateData: String @auth\n  }\n`;\n\n// Check auth in resolver\nconst resolvers = {\n  Query: {\n    privateData: (_, __, { user }) => {\n      if (!user) throw new AuthenticationError('Must be logged in');\n      return 'secret';\n    }\n  }\n};", "example": "Auth"},
    {"id": "gql16", "type": "dataloader", "name": "DataLoader", "description": "Batch queries", "pattern": "import DataLoader from 'dataloader';\n\nconst userLoader = new DataLoader(async (ids) => {\n  const users = await db.users.findByIds(ids);\n  return ids.map(id => users.find(u => u.id === id));\n});\n\n// In resolver\nPost: {\n  author: (parent, _, { loaders }) => {\n    return loaders.userLoader.load(parent.authorId);\n  }\n}", "example": "DataLoader"},
    {"id": "gql17", "type": "pagination", "name": "Pagination", "description": "Cursor pagination", "pattern": "const typeDefs = `#graphql\n  type Query {\n    posts(first: Int, after: String): PostConnection!\n  }\n  \n  type PostConnection {\n    edges: [PostEdge!]!\n    pageInfo: PageInfo!\n  }\n  \n  type PostEdge {\n    cursor: String!\n    node: Post!\n  }\n  \n  type PageInfo {\n    hasNextPage: Boolean!\n    endCursor: String\n  }\n`;", "example": "Pagination"},
    {"id": "gql18", "type": "error", "name": "Error Handling", "description": "Custom errors", "pattern": "import { GraphQLError } from 'graphql';\n\nconst resolvers = {\n  Mutation: {\n    createUser: (_, { input }) => {\n      if (!input.email.includes('@')) {\n        throw new GraphQLError('Invalid email', {\n          extensions: {\n            code: 'VALIDATION_ERROR',\n            field: 'email'\n          }\n        });\n      }\n    }\n  }\n};", "example": "Error"},
    {"id": "gql19", "type": "union", "name": "Union Types", "description": "Multiple types", "pattern": "const typeDefs = `#graphql\n  union SearchResult = User | Post | Comment\n  \n  type Query {\n    search(term: String!): [SearchResult!]!\n  }\n`;\n\nconst resolvers = {\n  SearchResult: {\n    __resolveType(obj) {\n      if (obj.email) return 'User';\n      if (obj.title) return 'Post';\n      return 'Comment';\n    }\n  }\n};", "example": "Union"},
    {"id": "gql20", "type": "interface", "name": "Interfaces", "description": "Shared fields", "pattern": "const typeDefs = `#graphql\n  interface Node {\n    id: ID!\n    createdAt: String!\n  }\n  \n  type User implements Node {\n    id: ID!\n    createdAt: String!\n    name: String!\n  }\n  \n  type Post implements Node {\n    id: ID!\n    createdAt: String!\n    title: String!\n  }\n`;", "example": "Interface"},
    {"id": "gql21", "type": "enum", "name": "Enums", "description": "Enum types", "pattern": "const typeDefs = `#graphql\n  enum Role {\n    ADMIN\n    USER\n    GUEST\n  }\n  \n  type User {\n    id: ID!\n    role: Role!\n  }\n  \n  type Query {\n    usersByRole(role: Role!): [User!]!\n  }\n`;", "example": "Enum"},
    {"id": "gql22", "type": "scalar", "name": "Custom Scalars", "description": "Custom types", "pattern": "import { GraphQLScalarType, Kind } from 'graphql';\n\nconst dateScalar = new GraphQLScalarType({\n  name: 'Date',\n  parseValue: (value) => new Date(value),\n  serialize: (value) => value.toISOString(),\n  parseLiteral: (ast) => {\n    if (ast.kind === Kind.STRING) {\n      return new Date(ast.value);\n    }\n    return null;\n  }\n});", "example": "Scalar"},
    {"id": "gql23", "type": "directive", "name": "Custom Directives", "description": "Schema directives", "pattern": "import { mapSchema, getDirective, MapperKind } from '@graphql-tools/utils';\n\nfunction upperDirectiveTransformer(schema) {\n  return mapSchema(schema, {\n    [MapperKind.OBJECT_FIELD]: (fieldConfig) => {\n      const directive = getDirective(schema, fieldConfig, 'upper')?.[0];\n      if (directive) {\n        const { resolve = defaultFieldResolver } = fieldConfig;\n        fieldConfig.resolve = async (source, args, context, info) => {\n          const result = await resolve(source, args, context, info);\n          return result.toUpperCase();\n        };\n      }\n    }\n  });\n}", "example": "Directive"},
    {"id": "gql24", "type": "caching", "name": "Caching", "description": "Response cache", "pattern": "const client = new ApolloClient({\n  uri: '/graphql',\n  cache: new InMemoryCache({\n    typePolicies: {\n      Query: {\n        fields: {\n          user: {\n            read(_, { args, toReference }) {\n              return toReference({ __typename: 'User', id: args.id });\n            }\n          }\n        }\n      }\n    }\n  })\n});", "example": "Caching"},
    {"id": "gql25", "type": "optimistic", "name": "Optimistic UI", "description": "Optimistic updates", "pattern": "const [createPost] = useMutation(CREATE_POST, {\n  optimisticResponse: {\n    createPost: {\n      __typename: 'Post',\n      id: 'temp-id',\n      title: formData.title,\n      content: formData.content\n    }\n  },\n  update: (cache, { data }) => {\n    cache.modify({\n      fields: {\n        posts(existing = []) {\n          const newPostRef = cache.writeFragment({ data: data.createPost });\n          return [...existing, newPostRef];\n        }\n      }\n    });\n  }\n});", "example": "Optimistic"},
    {"id": "gql26", "type": "refetch", "name": "Refetch Queries", "description": "Update after mutation", "pattern": "const [createPost] = useMutation(CREATE_POST, {\n  refetchQueries: [\n    { query: GET_POSTS },\n    'GetUserPosts'  // Query name\n  ],\n  awaitRefetchQueries: true,\n  onCompleted: (data) => {\n    console.log('Created:', data.createPost);\n  }\n});", "example": "Refetch"},
    {"id": "gql27", "type": "polling", "name": "Polling", "description": "Auto refresh", "pattern": "const { data, startPolling, stopPolling } = useQuery(GET_DATA, {\n  pollInterval: 5000  // Every 5 seconds\n});\n\n// Or manual control\nuseEffect(() => {\n  startPolling(1000);\n  return () => stopPolling();\n}, []);", "example": "Polling"},
    {"id": "gql28", "type": "lazy", "name": "Lazy Query", "description": "Manual execution", "pattern": "import { useLazyQuery } from '@apollo/client';\n\nfunction Search() {\n  const [search, { loading, data }] = useLazyQuery(SEARCH_QUERY);\n  \n  return (\n    <button onClick={() => search({ variables: { term: 'graphql' } })}>\n      Search\n    </button>\n  );\n}", "example": "Lazy"},
    {"id": "gql29", "type": "codegen", "name": "Code Generation", "description": "TypeScript types", "pattern": "// codegen.yml\nschema: http://localhost:4000/graphql\ndocuments: 'src/**/*.graphql'\ngenerates:\n  src/generated/graphql.ts:\n    plugins:\n      - typescript\n      - typescript-operations\n      - typescript-react-apollo\n\n// Run: npx graphql-codegen", "example": "Codegen"},
    {"id": "gql30", "type": "pattern", "name": "Best Practices", "description": "Patterns", "pattern": "// 1. Use DataLoader for N+1 prevention\n// 2. Implement pagination for large lists\n// 3. Use fragments for reusable fields\n// 4. Generate TypeScript types with codegen\n// 5. Cache normalized data on client", "example": "Patterns"}
  ]
}
