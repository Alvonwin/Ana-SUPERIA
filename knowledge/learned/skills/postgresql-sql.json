{
  "category": "postgresql-sql",
  "version": "1.0.0",
  "generatedBy": "Claude (Opus 4.5)",
  "description": "PostgreSQL relational database patterns",
  "skills": [
    {"id": "pgs01", "type": "setup", "name": "Install pg Driver", "description": "NPM install", "pattern": "npm install pg", "example": "NPM install"},
    {"id": "pgs02", "type": "connect", "name": "Connection", "description": "Connect client", "pattern": "const { Pool } = require('pg');\nconst pool = new Pool({ connectionString: process.env.DATABASE_URL });\nconst result = await pool.query('SELECT NOW()');", "example": "Connect"},
    {"id": "pgs03", "type": "connect", "name": "Connection Pool", "description": "Pool config", "pattern": "const pool = new Pool({ host: 'localhost', port: 5432, database: 'mydb', user: 'user', password: 'pass', max: 20 });", "example": "Pool"},
    {"id": "pgs04", "type": "query", "name": "Simple Query", "description": "Execute SQL", "pattern": "const result = await pool.query('SELECT * FROM users WHERE id = $1', [userId]);", "example": "Query"},
    {"id": "pgs05", "type": "query", "name": "Named Parameters", "description": "Parameterized", "pattern": "await pool.query('SELECT * FROM users WHERE name = $1 AND age > $2', ['John', 18]);", "example": "Parameters"},
    {"id": "pgs06", "type": "crud", "name": "INSERT", "description": "Insert row", "pattern": "const result = await pool.query('INSERT INTO users (name, email) VALUES ($1, $2) RETURNING *', ['John', 'john@example.com']);", "example": "Insert"},
    {"id": "pgs07", "type": "crud", "name": "UPDATE", "description": "Update row", "pattern": "await pool.query('UPDATE users SET name = $1 WHERE id = $2', ['Jane', userId]);", "example": "Update"},
    {"id": "pgs08", "type": "crud", "name": "DELETE", "description": "Delete row", "pattern": "await pool.query('DELETE FROM users WHERE id = $1', [userId]);", "example": "Delete"},
    {"id": "pgs09", "type": "transaction", "name": "Transaction", "description": "ACID transaction", "pattern": "const client = await pool.connect();\ntry {\n  await client.query('BEGIN');\n  await client.query('INSERT INTO...');\n  await client.query('COMMIT');\n} catch (e) {\n  await client.query('ROLLBACK');\n} finally {\n  client.release();\n}", "example": "Transaction"},
    {"id": "pgs10", "type": "table", "name": "CREATE TABLE", "description": "Define table", "pattern": "CREATE TABLE users (\n  id SERIAL PRIMARY KEY,\n  name VARCHAR(100) NOT NULL,\n  email VARCHAR(255) UNIQUE,\n  created_at TIMESTAMP DEFAULT NOW()\n);", "example": "Create table"},
    {"id": "pgs11", "type": "type", "name": "Data Types", "description": "Column types", "pattern": "INTEGER, BIGINT, SERIAL, VARCHAR(n), TEXT, BOOLEAN, DATE, TIMESTAMP, TIMESTAMPTZ, JSON, JSONB, UUID, ARRAY, ENUM", "example": "Data types"},
    {"id": "pgs12", "type": "constraint", "name": "Constraints", "description": "Table constraints", "pattern": "PRIMARY KEY, UNIQUE, NOT NULL, CHECK (age >= 0), FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE", "example": "Constraints"},
    {"id": "pgs13", "type": "index", "name": "Index", "description": "Create index", "pattern": "CREATE INDEX idx_users_email ON users(email);\nCREATE UNIQUE INDEX idx_users_unique_email ON users(email);\nCREATE INDEX idx_gin_tags ON posts USING GIN(tags);", "example": "Index"},
    {"id": "pgs14", "type": "json", "name": "JSONB Operations", "description": "JSON queries", "pattern": "SELECT * FROM users WHERE data->>'name' = 'John';\nSELECT data->'address'->>'city' FROM users;\nSELECT * FROM users WHERE data @> '{\"active\": true}';", "example": "JSONB"},
    {"id": "pgs15", "type": "json", "name": "JSON Functions", "description": "JSON helpers", "pattern": "jsonb_set(data, '{name}', '\"John\"')\njsonb_array_elements(data->'items')\njsonb_object_keys(data)", "example": "JSON functions"},
    {"id": "pgs16", "type": "join", "name": "JOIN", "description": "Table joins", "pattern": "SELECT u.name, p.title FROM users u\nINNER JOIN posts p ON u.id = p.user_id\nLEFT JOIN comments c ON p.id = c.post_id;", "example": "Join"},
    {"id": "pgs17", "type": "aggregate", "name": "Aggregations", "description": "Aggregate functions", "pattern": "SELECT department, COUNT(*), AVG(salary), MAX(salary)\nFROM employees\nGROUP BY department\nHAVING COUNT(*) > 5;", "example": "Aggregate"},
    {"id": "pgs18", "type": "window", "name": "Window Functions", "description": "Analytic queries", "pattern": "SELECT name, salary, RANK() OVER (ORDER BY salary DESC),\n  LAG(salary) OVER (ORDER BY hire_date),\n  SUM(salary) OVER (PARTITION BY department)\nFROM employees;", "example": "Window"},
    {"id": "pgs19", "type": "cte", "name": "CTE", "description": "Common table expr", "pattern": "WITH active_users AS (\n  SELECT * FROM users WHERE active = true\n)\nSELECT * FROM active_users WHERE age > 18;", "example": "CTE"},
    {"id": "pgs20", "type": "cte", "name": "Recursive CTE", "description": "Recursive query", "pattern": "WITH RECURSIVE subordinates AS (\n  SELECT id, name, manager_id FROM employees WHERE id = 1\n  UNION ALL\n  SELECT e.id, e.name, e.manager_id FROM employees e\n  INNER JOIN subordinates s ON e.manager_id = s.id\n)\nSELECT * FROM subordinates;", "example": "Recursive"},
    {"id": "pgs21", "type": "fulltext", "name": "Full-Text Search", "description": "Text search", "pattern": "SELECT * FROM posts\nWHERE to_tsvector('english', title || ' ' || body) @@ to_tsquery('english', 'postgres & database');", "example": "Full-text"},
    {"id": "pgs22", "type": "array", "name": "Array Operations", "description": "Array type", "pattern": "SELECT * FROM posts WHERE 'technology' = ANY(tags);\nSELECT unnest(tags) FROM posts;\nSELECT array_agg(name) FROM users;", "example": "Array"},
    {"id": "pgs23", "type": "upsert", "name": "UPSERT", "description": "Insert or update", "pattern": "INSERT INTO users (email, name) VALUES ($1, $2)\nON CONFLICT (email) DO UPDATE SET name = EXCLUDED.name;", "example": "Upsert"},
    {"id": "pgs24", "type": "view", "name": "Views", "description": "Create view", "pattern": "CREATE VIEW active_users AS SELECT * FROM users WHERE active = true;\nCREATE MATERIALIZED VIEW user_stats AS SELECT COUNT(*) FROM users;", "example": "View"},
    {"id": "pgs25", "type": "function", "name": "Functions", "description": "Stored function", "pattern": "CREATE FUNCTION get_user(user_id INTEGER) RETURNS users AS $$\n  SELECT * FROM users WHERE id = user_id;\n$$ LANGUAGE SQL;", "example": "Function"},
    {"id": "pgs26", "type": "trigger", "name": "Triggers", "description": "Event trigger", "pattern": "CREATE TRIGGER update_timestamp\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION update_modified_column();", "example": "Trigger"},
    {"id": "pgs27", "type": "notify", "name": "LISTEN/NOTIFY", "description": "Pub/sub", "pattern": "LISTEN channel_name;\nNOTIFY channel_name, 'payload';\n// In Node: client.on('notification', (msg) => { ... })", "example": "Pub/Sub"},
    {"id": "pgs28", "type": "copy", "name": "COPY", "description": "Bulk import", "pattern": "COPY users FROM '/path/to/file.csv' WITH (FORMAT csv, HEADER true);\nCOPY users TO '/path/to/output.csv' WITH (FORMAT csv);", "example": "Copy"},
    {"id": "pgs29", "type": "explain", "name": "EXPLAIN", "description": "Query plan", "pattern": "EXPLAIN ANALYZE SELECT * FROM users WHERE email = 'john@example.com';", "example": "Explain"},
    {"id": "pgs30", "type": "extension", "name": "Extensions", "description": "Add extensions", "pattern": "CREATE EXTENSION IF NOT EXISTS \"uuid-ossp\";\nCREATE EXTENSION IF NOT EXISTS \"pg_trgm\";\nCREATE EXTENSION IF NOT EXISTS \"postgis\";", "example": "Extensions"}
  ]
}
