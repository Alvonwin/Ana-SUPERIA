<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Test Vocal Auto-Submit</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #1a1a1a; color: #fff; }
        button { padding: 15px 30px; font-size: 18px; margin: 10px; cursor: pointer; }
        #status { margin: 20px 0; padding: 15px; background: #2c3e50; border-radius: 8px; }
        #log { margin: 20px 0; padding: 15px; background: #34495e; border-radius: 8px; font-family: monospace; }
    </style>
</head>
<body>
    <h1>üé§ Test Vocal Auto-Submit Direct</h1>
    <button onclick="testVocal()">üé§ D√©marrer Test Vocal</button>
    <div id="status">Pr√™t</div>
    <div id="log"></div>

    <script>
        const log = (msg) => {
            const logDiv = document.getElementById('log');
            logDiv.innerHTML += msg + '<br>';
            console.log(msg);
        };

        function testVocal() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

            if (!SpeechRecognition) {
                document.getElementById('status').innerHTML = '‚ùå Speech Recognition non support√©';
                return;
            }

            const recognition = new SpeechRecognition();
            recognition.lang = 'fr-FR';
            recognition.continuous = false;
            recognition.interimResults = false;

            recognition.onstart = () => {
                document.getElementById('status').innerHTML = 'üé§ √âcoute en cours...';
                log('üé§ Enregistrement d√©marr√©');
            };

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                log('üìù Transcription: "' + transcript + '"');

                // CRITICAL: Auto-submit imm√©diat
                log('üöÄ Auto-submit dans 200ms...');
                setTimeout(() => {
                    log('‚úÖ AUTO-SUBMIT D√âCLENCH√â - Message: "' + transcript + '"');
                    document.getElementById('status').innerHTML = '‚úÖ Message envoy√©: "' + transcript + '"';
                }, 200);
            };

            recognition.onerror = (event) => {
                log('‚ùå Erreur: ' + event.error);
                document.getElementById('status').innerHTML = '‚ùå Erreur: ' + event.error;
            };

            recognition.onend = () => {
                log('‚èπÔ∏è Enregistrement termin√©');
            };

            recognition.start();
        }
    </script>
</body>
</html>
